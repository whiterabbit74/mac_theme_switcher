# Feature: Theme Switcher для macOS
## Problem
Пользователи macOS часто переключают системную тему вручную через Системные настройки, что занимает время. Нет простого способа быстро переключить тему одним кликом из меню-бара.

## Goals
- Создать нативное macOS приложение для быстрого переключения темы
- Интегрировать в меню-бар для постоянного доступа
- Поддержать M1/M-серию процессоров
- Обеспечить мгновенное переключение без задержек

## Non-Goals
- Не создавать веб-приложение
- Не добавлять дополнительные функции (таймеры, расписания)
- Не поддерживать старые Intel процессоры
- Не интегрироваться с другими ОС

## Target Users & Use-cases
**Пользователи**: Пользователи macOS с M1/M-серией, часто переключающие темы
**Кейсы**:
- Быстрое переключение темы при работе в разное время суток
- Демонстрация интерфейса в разных темах
- Экономия времени при частом переключении

## Scope (in) / Out-of-scope
**In Scope**:
- Нативное Swift приложение для macOS
- Интеграция в меню-бар
- Определение текущей системной темы
- Переключение между светлой/темной темой
- Визуальная индикация текущей темы

**Out-of-scope**:
- Настройки автопереключения
- Кастомные цвета/темы
- Системные уведомления
- Глобальные горячие клавиши

## UX Notes / Wireframes (словесно)
**Меню-бар**: Иконка приложения в правой части меню-бара
**Иконка**: Динамическая - солнце (светлая тема) / луна (темная тема)
**Меню**: При клике показывает:
- Текущую тему (активный пункт)
- Опцию переключения
- Разделитель
- Настройки (будущая функция)
- Выход

**Взаимодействие**: Один клик по иконке → мгновенное переключение темы

## API / Data Schema (таблицы/поля/типы/контракты)
**macOS API**:
- `NSAppearance.current` - получение текущей темы
- `NSApp.appearance` - установка темы приложения
- `NSStatusBar` - работа с меню-баром
- `NSDistributedNotificationCenter` - отслеживание системных изменений

**Данные**:
- `ThemeState`: enum { light, dark, auto }
- `MenuIcon`: enum { sun, moon }

## Acceptance Criteria (Given-When-Then)
**AC1: Определение текущей темы**
- Given: Приложение запущено
- When: Пользователь открывает меню
- Then: Показывается текущая системная тема

**AC2: Переключение темы**
- Given: Приложение активно в меню-баре
- When: Пользователь кликает по иконке
- Then: Системная тема переключается (светлая↔темная)

**AC3: Визуальная индикация**
- Given: Тема изменена
- When: Пользователь смотрит на меню-бар
- Then: Иконка соответствует текущей теме (солнце/луна)

**AC4: Производительность**
- Given: Приложение запущено
- When: Пользователь переключает тему
- Then: Переключение происходит < 100ms

## Risks & Assumptions
**Риски**:
- Apple может изменить API тем в будущих версиях macOS
- Права доступа к системным настройкам могут быть ограничены
- Конфликты с другими приложениями управления темами

**Предположения**:
- Пользователь имеет права администратора для изменения системных настроек
- macOS 12.0+ с поддержкой нативного переключения тем
- M1/M-серия поддерживает все необходимые API

## Test Plan (критические кейсы)
**T1: Переключение тем**
- Запуск на macOS с M1
- Проверка переключения светлая→темная→светлая
- Верификация через `defaults read -g AppleInterfaceStyle`

**T2: Интеграция с меню-баром**
- Проверка отображения иконки в меню-баре
- Тестирование контекстного меню
- Проверка работы после перезагрузки системы

**T3: Производительность**
- Измерение времени переключения (< 100ms)
- Проверка потребления ресурсов (< 10MB RAM)

## Rollout & Monitoring
**Релиз**:
- Beta: 10 пользователей, сбор фидбэка
- Stable: App Store или прямое распространение

**Мониторинг**:
- Отслеживание сбоев через Crash Reports
- Сбор метрик производительности
- Мониторинг отзывов в App Store

**Откат**:
- Удаление из меню-бара
- Деинсталляция через стандартный процесс macOS

## Change Log
- v1.0: Initial PRD created
